import { Injectable } from '@nestjs/common'
import {HttpService} from '@nestjs/axios'
import axios, { AxiosResponse } from 'axios';
import { Observable } from 'rxjs';
import { map } from 'rxjs/operators';
import { URLSearchParams } from 'url';
import * as fs from 'fs';
import * as path from 'path';


@Injectable()
export class HttpConsumingService {
  
  constructor(private readonly http: HttpService) {}

  private id : String;

  setId(id: String) {
    this.id = id;
  }

  callHttp(): Observable<Array<Object>> {
    let url = 'https://i1api.nrs.gov.bc.ca/ttls-api/v1/dispositionTrans/info/' + this.id;
    console.log(url);
    return this.http.get(url, { headers: {"Authorization" : `Bearer DB209A1605D5488BE0533954228E4942`}}).pipe(
      map((axiosResponse: AxiosResponse) => {
        return axiosResponse.data;
      })
    );
  }

  callGetToken(): Promise<Object> {
    let url = 'https://dev.oidc.gov.bc.ca/auth/realms/jbd6rnxw/protocol/openid-connect/token';
    let service_client_id = 'MALS_SERVICE_CLIENT';
    let service_client_secret = '8b15adbd-2ab7-4e24-9d0f-3efccf738225'

    const token = `${service_client_id}:${service_client_secret}`;
    const encodedToken = Buffer.from(token).toString('base64');
    let config = {
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
        'Authorization' : 'Basic '+encodedToken
      }
    };

    const grantTypeParam = new URLSearchParams();
    grantTypeParam.append('grant_type','client_credentials');

    return axios.post(url, grantTypeParam,  config).then(response => {console.log(response); return response.data.access_token})
    .catch(error => {
        console.log(error.response)
    });
  }

  async generateReport() {

    let cdogsToken = await this.callGetToken();

    let url = 'https://cdogs-dev.apps.silver.devops.gov.bc.ca/api/v2/template/render';
    console.log(url);

    // const formatters = {"myFormatter":"_function_myFormatter|function(data) { return data.slice(1); }","myOtherFormatter":"_function_myOtherFormatter|function(data) {return data.slice(2);}"};
    

    const buffer = fs.readFileSync(path.resolve(__dirname, './public/' + 'LUR_Template.docx'), 'utf8')

    const bufferBase64 = 'eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI5Rm5UcVlVRkxnbTFIbTJIOThnWEJhWnpPcXBnMFlWU1NvNHBESlVuNXZ3In0.eyJleHAiOjE2NDgzNTU2NzMsImlhdCI6MTY0ODM1NTM3MywianRpIjoiNmJlZTE5OTMtMGFhMC00YzBmLWIzNDctM2Q1ZTI1MDA2MTMyIiwiaXNzIjoiaHR0cHM6Ly9kZXYub2lkYy5nb3YuYmMuY2EvYXV0aC9yZWFsbXMvamJkNnJueHciLCJhdWQiOlsiQ0RPR1MiLCJDSEVTIl0sInN1YiI6ImEwODMzMDYxLTkzZTQtNDVkMi1hYzE3LWIxMzI0NDdiYjRiNCIsInR5cCI6IkJlYXJlciIsImF6cCI6Ik1BTFNfU0VSVklDRV9DTElFTlQiLCJhY3IiOiIxIiwicmVzb3VyY2VfYWNjZXNzIjp7IkNET0dTIjp7InJvbGVzIjpbIkdFTkVSQVRPUiIsInVtYV9wcm90ZWN0aW9uIl19LCJDSEVTIjp7InJvbGVzIjpbIkVNQUlMRVIiLCJ1bWFfcHJvdGVjdGlvbiJdfSwiTUFMU19TRVJWSUNFX0NMSUVOVCI6eyJyb2xlcyI6WyJ1bWFfcHJvdGVjdGlvbiIsIkNPTU1PTl9TRVJWSUNFUyJdfX0sInNjb3BlIjoiIiwiY2xpZW50SWQiOiJNQUxTX1NFUlZJQ0VfQ0xJRU5UIiwiY2xpZW50SG9zdCI6Ijc1LjE1NC4yNDAuMTkzIiwiY2xpZW50QWRkcmVzcyI6Ijc1LjE1NC4yNDAuMTkzIn0.EpPGEbT8YriVzHARdkD6BwvVq6t5CgtQ_N7-_df4k4pHWrXmhtzCNVY38UketBk2ONrPSuOGHWdmnRfRgY0hF-4CeLttoj5H8Rto-B6667_NGdVWfGglkI8msnnAsDXG0Jj21cLDIvnpCGnQexFfHF6NicwiE06907s4TnlXb_cwrBqEU1u5UkrDgqK7AZUu_6j__HUj8XA3DC1l4x8zcofV4p4rnMEgLncLfaet0_A6lqGeS2V0LoR-6raWQWdqYrkXTxz98t7wuaOYKyPfduwUDw_7LvoeboQVzzauoj7znON5Q4TV4NF2MI9z_MUDaL1QXmOCSW2yb_ITuOC3-Q'//Buffer.from(buffer).toString('base64');

    const jsonBody = {
      "firstName": "Jane",
      "lastName": "Smith",
      "title": "CEO"
  };
    
    const options = {
      reportName: 'test.pdf',
      convertTo: 'pdf',
      overwrite: true      
    };

    const template = {
      content: ''+bufferBase64,
      encodingType: 'base64',
      fileType: 'docx'      
    };

    


    const bodyParameters = {
      data: jsonBody,
      options: options,
      template: template    
   };

   //let config = {
    //headers: {
//      'Content-Type': 'application/json',
      //'Authorization': 'Bearer ' +cdogsToken
    //}
  //};
/*

    return axios.post(url, bodyParameters,config)
    .then(response => {console.log("blablabla2");return response.data})
    .catch(error => {
      console.log("blablabla");
        console.log(error)
    });
  }
  */

  var data = JSON.stringify({
    "data": {
      "firstName": "Jane",
      "lastName": "Smith",
      "title": "CEO"
    },
    "formatters": "{\"myFormatter\":\"_function_myFormatter|function(data) { return data.slice(1); }\",\"myOtherFormatter\":\"_function_myOtherFormatter|function(data) {return data.slice(2);}\"}",
    "options": {
      "cacheReport": true,
      "convertTo": "pdf",
      "overwrite": true,
      "reportName": "{d.firstName}-{d.lastName}.pdf"
    },
    "template": {
      "encodingType": "base64",
      "fileType": "docx",
      "content": "UEsDBBQABgAIAAAAIQDfpNJsWgEAACAFAAATAAgCW0NvbnRlbnRfVHlwZXNdLnhtbCCiBAIooAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC0lMtuwjAQRfeV+g+Rt1Vi6KKqKgKLPpYtUukHGHsCVv2Sx7z+vhMCUVUBkQpsIiUz994zVsaD0dqabAkRtXcl6xc9loGTXmk3K9nX5C1/ZBkm4ZQw3kHJNoBsNLy9GUw2ATAjtcOSzVMKT5yjnIMVWPgAjiqVj1Ykeo0zHoT8FjPg973eA5feJXApT7UHGw5eoBILk7LXNX1uSCIYZNlz01hnlUyEYLQUiep86dSflHyXUJBy24NzHfCOGhg/mFBXjgfsdB90NFEryMYipndhqYuvfFRcebmwpCxO2xzg9FWlJbT62i1ELwGRztyaoq1Yod2e/ygHpo0BvDxF49sdDymR4BoAO+dOhBVMP69G8cu8E6Si3ImYGrg8RmvdCZFoA6F59s/m2NqciqTOcfQBaaPjP8ber2ytzmngADHp039dm0jWZ88H9W2gQB3I5tv7bfgDAAD//wMAUEsDBBQABgAIAAAAIQAekRq37wAAAE4CAAALAAgCX3JlbHMvLnJlbHMgogQCKKAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArJLBasMwDEDvg/2D0b1R2sEYo04vY9DbGNkHCFtJTBPb2GrX/v082NgCXelhR8vS05PQenOcRnXglF3wGpZVDYq9Cdb5XsNb+7x4AJWFvKUxeNZw4gyb5vZm/cojSSnKg4tZFYrPGgaR+IiYzcAT5SpE9uWnC2kiKc/UYySzo55xVdf3mH4zoJkx1dZqSFt7B6o9Rb6GHbrOGX4KZj+xlzMtkI/C3rJdxFTqk7gyjWop9SwabDAvJZyRYqwKGvC80ep6o7+nxYmFLAmhCYkv+3xmXBJa/ueK5hk/Nu8hWbRf4W8bnF1B8wEAAP//AwBQSwMEFAAGAAgAAAAhANZks1H0AAAAMQMAABwACAF3b3JkL19yZWxzL2RvY3VtZW50LnhtbC5yZWxzIKIEASigAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArJLLasMwEEX3hf6DmH0tO31QQuRsSiHb1v0ARR4/qCwJzfThv69ISevQYLrwcq6Yc8+ANtvPwYp3jNR7p6DIchDojK971yp4qR6v7kEQa1dr6x0qGJFgW15ebJ7Qak5L1PWBRKI4UtAxh7WUZDocNGU+oEsvjY+D5jTGVgZtXnWLcpXndzJOGVCeMMWuVhB39TWIagz4H7Zvmt7ggzdvAzo+UyE/cP+MzOk4SlgdW2QFkzBLRJDnRVZLitAfi2Myp1AsqsCjxanAYZ6rv12yntMu/rYfxu+wmHO4WdKh8Y4rvbcTj5/oKCFPPnr5BQAA//8DAFBLAwQUAAYACAAAACEApwv382IDAAB3DQAAEQAAAHdvcmQvZG9jdW1lbnQueG1spJdLc6s2FID3nel/YNjH4mEbm4l9x7GT2yzaudO0iy4VEKC5CGkk2Y7b6X/vkQBjh/QOJl6AXufTeekg3395Y6VzIFJRXq1cf+K5DqkSntIqX7l//vF0t3AdpXGV4pJXZOWeiHK/rH/+6f4YpzzZM1JpBxCVio8iWbmF1iJGSCUFYVhNGE0kVzzTk4QzxLOMJgQduUxR4PmebQnJE6IU7LfF1QErt8Elb8NoqcRHEDbAKUoKLDV56xj+zZAZWqJFHxSMAIGFgd9HhTej5sho1QNNR4FAqx5pNo70gXHzcaSgT4rGkcI+aTGO1Esn1k9wLkgFkxmXDGvoyhwxLL/vxR2ABdb0lZZUn4DpzVsMptX3ERqB1JnAwvRmQoQYT0kZpi2Fr9y9rOJG/u4sb1SPa/nm1UrIIfbXIrumOFjLkSQl+IJXqqDifMLZWBpMFi3k8CMjDqxs1x2FP/C4/F952tWu7IBD1G/8z8pa8x8TfW9ARAziLDFEhes9W00YZGG38SjXXDjXH1hAWkDQA8wTMrDgt4xFw0BJd0INhw48Gi2njorh0M6x/sA69l6ZC4AityFmrR7qxC4sEvnn0var5HvR0ejnaM9dETqa68ANrCb9L4+k+pwyLwUWUJtYEj/nFZf4tQSNIJkdyEfHRsA8IazmZZvkzTGFwF3D9eWVpyfzFjAzjQWW+BkyZ7bcet72KXDtKBR/bUY972mzDfwljMZwVUp/N0ObTRjuFuehHcnwvtRmZuZNw+XC7iLNQ69/IWXJnX/ukemYpx0HU3j2KCUg9EmA8krAuhcNXx0XXUink4xKpX/DjAwiPFbplfy/76TM8s6MyIvmD1ZZe5WLlcAJkIQkisgDcdfOe/GaOt6aEn/GmMmVGDxFP4zho/8QhLPtuzBGu2ix3G6uwtgEa1AY/+J7B0vi4NtD2VuQS8w+co6murzRMx+yR/ktCra7h41nEv3Cb1Hzu81vdnNFEv3tKt+u5V5g3oxGs8ALPOtrkb/8DbPwcfODYOqZlQW0Zwto1+bmv2JrK4dvsD+tl0iaF7rrvnKtOev6JckuZguCUwK3mcizimSc64tuvte222yX8FLBaHMszBo7DH9/vkpTW+KSVuQb1QloGc6tEGoNt8260qDuH9P6PwAAAP//AwBQSwMEFAAGAAgAAAAhALb0Z5jSBgAAySAAABUAAAB3b3JkL3RoZW1lL3RoZW1lMS54bWzsWUuLG0cQvgfyH4a5y3rN6GGsNdJI8mvXNt61g4+9UmumrZ5p0d3atTCGYJ9yCQSckEMMueUQQgwxxOSSH2OwSZwfkeoeSTMt9cSPXYMJu4JVP76q/rqquro0c+Hi/Zg6R5gLwpKOWz1XcR2cjNiYJGHHvX0wLLVcR0iUjBFlCe64Cyzcizuff3YBnZcRjrED8ok4jzpuJOXsfLksRjCMxDk2wwnMTRiPkYQuD8tjjo5Bb0zLtUqlUY4RSVwnQTGovTGZkBF2DpRKd2elfEDhXyKFGhhRvq9UY0NCY8fTqvoSCxFQ7hwh2nFhnTE7PsD3petQJCRMdNyK/nPLOxfKayEqC2RzckP9t5RbCoynNS3Hw8O1oOf5XqO71q8BVG7jBs1BY9BY69MANBrBTlMups5mLfCW2BwobVp095v9etXA5/TXt/BdX30MvAalTW8LPxwGmQ1zoLTpb+H9XrvXN/VrUNpsbOGblW7faxp4DYooSaZb6IrfqAer3a4hE0YvW+Ft3xs2a0t4hirnoiuVT2RRrMXoHuNDAGjnIkkSRy5meIJGgAsQJYecOLskjCDwZihhAoYrtcqwUof/6uPplvYoOo9RTjodGomtIcXHESNOZrLjXgWtbg7y6sWLl4+ev3z0+8vHj18++nW59rbcZZSEebk3P33zz9Mvnb9/+/HNk2/teJHHv/7lq9d//Plf6qVB67tnr58/e/X913/9/MQC73J0mIcfkBgL5zo+dm6xGDZoWQAf8veTOIgQyUt0k1CgBCkZC3ogIwN9fYEosuB62LTjHQ7pwga8NL9nEN6P+FwSC/BaFBvAPcZoj3Hrnq6ptfJWmCehfXE+z+NuIXRkWzvY8PJgPoO4JzaVQYQNmjcpuByFOMHSUXNsirFF7C4hhl33yIgzwSbSuUucHiJWkxyQQyOaMqHLJAa/LGwEwd+GbfbuOD1Gber7+MhEwtlA1KYSU8OMl9BcotjKGMU0j9xFMrKR3F/wkWFwIcHTIabMGYyxEDaZG3xh0L0Gacbu9j26iE0kl2RqQ+4ixvLIPpsGEYpnVs4kifLYK2IKIYqcm0xaSTDzhKg++AElhe6+Q7Dh7ref7duQhuwBombm3HYkMDPP44JOELYp7/LYSLFdTqzR0ZuHRmjvYkzRMRpj7Ny+YsOzmWHzjPTVCLLKZWyzzVVkxqrqJ1hAraSKG4tjiTBCdh+HrIDP3mIj8SxQEiNepPn61AyZAVx1sTVe6WhqpFLC1aG1k7ghYmN/hVpvRsgIK9UX9nhdcMN/73LGQObeB8jg95aBxP7OtjlA1FggC5gDBFWGLd2CiOH+TEQdJy02t8pNzEObuaG8UfTEJHlrBbRR+/gfr/aBCuPVD08t2NOpd+zAk1Q6Rclks74pwm1WNQHjY/LpFzV9NE9uYrhHLNCzmuaspvnf1zRF5/mskjmrZM4qGbvIR6hksuJFPwJaPejRWuLCpz4TQum+XFC8K3TZI+Dsj4cwqDtaaP2QaRZBc7mcgQs50m2HM/kFkdF+hGawTFWvEIql6lA4MyagcNLDVt1qgs7jPTZOR6vV1XNNEEAyG4fCazUOZZpMRxvN7AHeWr3uhfpB64qAkn0fErnFTBJ1C4nmavAtJPTOToVF28KipdQXstBfS6/A5eQg9Ujc91JGEG4Q0mPlp1R+5d1T93SRMc1t1yzbayuup+Npg0Qu3EwSuTCM4PLYHD5lX7czlxr0lCm2aTRbH8PXKols5AaamD3nGM5c3Qc1IzTruBP4yQTNeAb6hMpUiIZJxx3JpaE/JLPMuJB9JKIUpqfS/cdEYu5QEkOs591Ak4xbtdZUe/xEybUrn57l9FfeyXgywSNZMJJ1YS5VYp09IVh12BxI70fjY+eQzvktBIbym1VlwDERcm3NMeG54M6suJGulkfReN+SHVFEZxFa3ij5ZJ7CdXtNJ7cPzXRzV2Z/uZnDUDnpxLfu24XURC5pFlwg6ta054+Pd8nnWGV532CVpu7NXNde5bqiW+LkF0KOWraYQU0xtlDLRk1qp1gQ5JZbh2bRHXHat8Fm1KoLYlVX6t7Wi212eA8ivw/V6pxKoanCrxaOgtUryTQT6NFVdrkvnTknHfdBxe96Qc0PSpWWPyh5da9Savndeqnr+/XqwK9W+r3aQzCKjOKqn649hB/7dLF8b6/Ht97dx6tS+9yIxWWm6+CyFtbv7qu14nf3DgHLPGjUhu16u9cotevdYcnr91qldtDolfqNoNkf9gO/1R4+dJ0jDfa69cBrDFqlRjUISl6joui32qWmV6t1vWa3NfC6D5e2hp2vvlfm1bx2/gUAAP//AwBQSwMEFAAGAAgAAAAhAJBSIebaAwAAIgsAABEAAAB3b3JkL3NldHRpbmdzLnhtbLRW32/bNhB+H7D/wdDzFEm2ZMtCnSJ24CVFvA6Vhz1TEmUT4Q+BpOy6w/73HSnRcpeicFrkxSLvu/vuSH48+t37z4yODlgqIvjCi25Cb4R5KSrCdwvvr+3aT72R0ohXiAqOF94JK+/97a+/vDtmCmsNbmoEFFxlrFx4e62bLAhUuccMqRvRYA5gLSRDGqZyFzAkn9vGLwVrkCYFoUSfgnEYTr2eRiy8VvKsp/AZKaVQotYmJBN1TUrcf1yEvCZvF3IvypZhrm3GQGIKNQiu9qRRjo39KBuAe0dy+N4iDow6v2MUXrHco5DVOeKa8kxAI0WJlYIDYtQVSPiQOH5BdM59A7n7JVoqCI9CO7qsPHkdwfgFwbTEn1/HkfYcAURe8pDqdTzTMw8ZNjaa/lgxFwQKv44icXWoExtWpOg1Z9xBT6SQSHY3qD9gVmaPOy4kKiiUAwc9grMa2erMLyzZfOwQct7CRT4QfBzBB0HiIy68wBi/CMHA2GBZgsShNYRhB4CwRJ1rpIEuUw2m1PaKkmIE2Y/ZTiIGt9xZbEyFa9RSvUVFrkXjcs3GPWW5RxKVGsu8QSWwrQTXUlDnV4k/hF5Bx5Ag6D7C9o9hlHe9CCI4YrDsr/rLRlTYVNZKcv35mACbPUouU/4/kYDeKUmFt2a7c32ieA3F5+QLvuPVh1ZpAoy2y/xEBd8rAHOT+SMIZHtq8Boj3cI2vVEyexJrSpoNkVLIR16BNt4sGalrLCEBAa1tQD5EiqPd5weMKniy3ihvq/Df4Az3c7IFWT4vhdaCPZyaPez1z52k1XtwKV94eCvlBp+E0GfXMAnjyTztKjXoNcgsGYfuVn2N3M3C2XT5TeRuMrm3bMG5HpaZ5+xP6UZG1CPWRawQKyRBo4158ALjUcjnJeEOLzD0KXyJ5G3hQN/vAMUQpWvYXgfYollWEdXc49qO6QbJ3cDbe8hvWqHDfDhzmY6F5e9StE2HHiVqOrE6lyiO+0jC9RNhzq7aIndRHDrrBdTy6uNB2n0atueYaTh8e+mfkBWR9cXcX931IqMyNwLBG9Q0nc6KXbTwKNntdWSkoWFWwf8iOyl24x4bW2zcYXaCSrMy8O4Hg23sbBd+E2ebDLbY2eLBljhbMtimzjY1tj10Fglt/hkk74bGXgtKxRFXDwP+wuQegJLAiecnVgx9/abDKFFwBxt4ArSQDvvNYlGcVaJ8NC9W7OS6DMN01Qk5SuzToe01ha39hOslUrjqMReadKH/zNJlGKdh5K/ny4mfpvHcT8fzxL9fTtPpfL2K03n6b38P3J/b2/8AAAD//wMAUEsDBBQABgAIAAAAIQARWTKEcgEAAPECAAARAAgBZG9jUHJvcHMvY29yZS54bWwgogQBKKAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACMklFPgzAUhd9N/A+k71BgOg0BlqjZk0tMnNH4Vtu7rRu0TduN8e8tMJjoHny7t+e7h8tp09mxLLwDaMOlyFAUhMgDQSXjYp2ht+Xcv0eesUQwUkgBGarBoFl+fZVSlVCp4UVLBdpyMJ5zEiahKkMba1WCsaEbKIkJHCGcuJK6JNa1eo0VoTuyBhyH4RSXYAkjluDG0FeDIzpZMjpYqr0uWgNGMRRQgrAGR0GEz6wFXZqLA63ygyy5rRVcRHtxoI+GD2BVVUE1aVG3f4Q/Fs+v7a/6XDRZUUB5ymhiuS0gT/G5dJXZf22B2u54aFxNNRArdb4lRgrPbNyyRLRUrzSZ76CupGbGzY86hzEwVHNl3U127qMDRxfE2IW72hUH9lD//tBfoJnRcODN28jjlhja9BR0txwwzwWUdHH2yvvk8Wk5R3kcxqEfTv3obhnHyc00CcPPZr/R/NmwPC3wb8fbu7Fjb9BFNH6k+TcAAAD//wMAUEsDBBQABgAIAAAAIQAuELr22QEAAB8GAAASAAAAd29yZC9mb250VGFibGUueG1s3JJdb9sgFIbvJ+0/IO4bY+ejmVWn2kcjTZp2UXU/gGBsoxmwOCRu/v0O2MmiRZXqXvRitoThPZyHw+tzd/+sW3KQDpQ1BU1njBJphC2VqQv662l7s6YEPDclb62RBT1KoPebjx/u+ryyxgPBfAO5FgVtvO/yJAHRSM1hZjtpMFhZp7nHpasTzd3vfXcjrO64VzvVKn9MMsZWdMS411BsVSkhv1mx19L4mJ842SLRGmhUByda/xpab13ZOSskAN5ZtwNPc2XOmHRxBdJKOAu28jO8zFhRRGF6yuJMt38By2mA7AqwEvJ5GmM9MhLMvOSochpndeao8oLztmIuACCnIZanOuCow420yL/Xxjq+a5GE/4igzSSCw4jVhk+c4vbN2K+kzw3XmPCVt2rnVAx03FiQKcYOvC0oy9iWLXEM74LNw0iTsFE03IEMkGEjG+SKa9UeTyr0CmAIdMqL5qQfuFOh2CEEqsbAHnasoA+MsezzdksHJcXqgrK4/TIqWTgrPp9GZX5WWFBE5MRlOnBE5Jz34JnJ4MCVE09KSyA/ZU8erebmBUcytkInluhHcGY+yREXuZMdefjXkdv18l0cGXuD/FB141/skNAX/2mHjBPY/AEAAP//AwBQSwMEFAAGAAgAAAAhAEDB//E5AQAAIwMAABQAAAB3b3JkL3dlYlNldHRpbmdzLnhtbJzSX0/CMBAA8HcTv8PSd+ggspCFQWIMxhdjon6A0t2gse0tveLAT+9tAmJ4Yb70//1y13a22DmbfEIgg74Qo2EqEvAaS+PXhXh/Ww6mIqGofKkseijEHkgs5rc3syZvYPUKMfJJSljxlDtdiE2MdS4l6Q04RUOswfNmhcGpyNOwlk6Fj2090OhqFc3KWBP3cpymmTgw4RoFq8poeEC9deBjFy8DWBbR08bUdNSaa7QGQ1kH1EDE9Tj74zll/IkZ3V1AzuiAhFUccjGHjDqKw0dpN3L2F5j0A8YXQKZh18+YHgzJkeeOKfs52ckx5Znzv2TOAIJ+xOSYB+1dW5HT+dPaY1AryxK/UcLXnHRw23K2bdcN+ficfy3W0TjzBUsM9wEbgiDbZWUtNi/PjzyRf772/BsAAP//AwBQSwMEFAAGAAgAAAAhANUYb+JMCwAAXnIAAA8AAAB3b3JkL3N0eWxlcy54bWy8nVtX4zgSx9/3nP0OPnmafaDDNXRzhp4DdLNwFnqYCWw/K7ZCtMhW1na47KdfSXYShbIcl1zDSze51M+y/vqXVL7l199eUxk987wQKjsd7H3aHUQ8i1UissfTwcP95c7nQVSULEuYVBk/HbzxYvDb17//7deXk6J8k7yINCArTtL4dDAry/nJcFjEM56y4pOa80x/OFV5ykr9Mn8cpix/Wsx3YpXOWSkmQorybbi/uzsa1Ji8C0VNpyLm31S8SHlW2vhhzqUmqqyYiXmxpL10ob2oPJnnKuZFoXc6lRUvZSJbYfYOASgVca4KNS0/6Z2pW2RROnxv1/6VyjXgCAfYB4BRzF9xjM81Y6gjXY5IcJzRiiMShxPWGAdQcBziaNmO4i01e5TGJ9ePmcrZRGqS1ijS3RxZsPlXt9b8Z//UX/+qB2yi4m98yhayLMzL/C6vX9av7H+XKiuL6OWEFbEQ97pdGp4KvZ2rs6wQA/0JZ0V5VgjW+OHM/NH4SVyUztvnIhGDodli8T/94TOTp4P9w+U7F6YFG+9Jlj0u3+PZzsWZ2xL71sPYvDXR3NMBy3fGZyZwWO9Y9b+zu/PVq+pb7/pGm0lba1w5XH/KpzcqfuLJuNQfnA52zab0mw/Xd7lQuXbx6eDLl/rNMU/FlUgSnjlfzGYi4T9nPHsoeLJ+/49L68T6jVgtMv33wfHI6iWL5PtrzOfG1/rTjJne+2ECpPn2Qqw3bsP/u4Tt1X3WFD/jzCS3aO89wjYfhdg3EYWzt83Mxbt9t99CbejgozZ0+FEbOvqoDY0+akPHH7Whzx+1IYv5KzcksoS/VkaEmwHUbRyPG9Ecj9nQHI+X0ByPVdAcjxPQHM9AR3M84xjN8QxTBKdUsW8UOoP9wDPa27nb54gw7vYpIYy7fQYI425P+GHc7fk9jLs9nYdxt2fvMO72ZI3nVkut6FrbLCt7u2yqVJmpkkclf+1PY5lm2YqPhmcmPZ6T7CQBpsps9UTcmxYz+3r7CLEmDZ/PS1OKRWoaTcXjIudF74bz7JlLXbJHLEk0jxCY83KRe3okZEznfMpznsWccmDTQaXIeJQt0gnB2JyzRzIWzxLi7lsSSZLCakCzRTkzJhEEgzplca76N00xsvxwI4r+fWUg0flCSk7E+kEzxCyrf21gMf1LA4vpXxlYTP/CwNGMqotqGlFP1TSiDqtpRP1WjU+qfqtpRP1W04j6rab177d7UUqb4t1Vx173Y3cXUplj9L3bMRaPGdMLgP7TTX3MNLpjOXvM2XwWmePHzVh3n7HbOVfJW3RPMaetSFTrejtELvRei2zRv0M3aFTmWvGI7LXiERlsxetvsVu9TDYLtCuaema8mJSNprWkTqYdM7moFrT93cbK/iNsbYBLkRdkNmjGEozgH2Y5a+SkyHzrVvZv2JrV31bvsxJp82okQSulip9o0vDV25znuix76k26VFKqF57QEcdlrqqx5lp+30rSyfLf0/mMFcLWShuI7lP98ux+dMvmvXfoTjKR0ej2fSdlQkZ0K4ir+9ub6F7NTZlpOoYGeK7KUqVkzPpI4C8/+eQfNA0800Vw9ka0t2dEh4cs7EIQTDIVSSVEJL3MFJkgmUMt71/8baJYntDQ7nJeXVBTciLimKXzatFB4C2dF190/iFYDVnev1kuzHEhKlPdk8Ccw4bFYvIfHvdPdT9URHJk6PdFaY8/2qWujabD9V8mbOD6LxGsmnp6MOOXYGc3cP13dgNHtbMXkhWF8J5CDeZR7e6SR72//Yu/mqekyqcLSdeBSyBZDy6BZF2o5CLNCso9tjzCHbY86v0lHDKWR3BIzvL+mYuETAwLo1LCwqhksDAqDSyMVID+V+g4sP6X6Tiw/tfqVDCiJYADoxpnpNM/0VkeB0Y1ziyMapxZGNU4szCqcXbwLeLTqV4E000xDpJqzDlIuokmK3k6VznL34iQ3yV/ZAQHSCvaXa6m5k4LlVUXcRMgzTFqSbjYrnBUIv/kE7KmGRZluwiOiDIplSI6traecGzk5rVr28LsPRe9m3AnWcxnSiY89+yTP1bXy+M5i+vD9OB0X6fDnjficVZG49nqaL+LGe1ujVwW7Bth2zfY1Oej/ZawW56IRbpsKLyZYnTQPdiO6I3g5T0vLcHrlcRG5FHHSLjN0fbI9Sp5I/K4YyTc5ueOkdanG5FtfvjG8qfGgXDcNn5WNZ5n8B23jaJVcONm2wbSKrJpCB63jaINq0RncWzOFkB1unnGH9/NPP54jIv8FIyd/JTOvvIj2gz2J38WZmbHJE27vdXVEyDv20V0p8z5x0JVx+03Tjh1v6nrWi+csoJHjZyD7ieuNrKMvx87pxs/onPe8SM6JyA/olMm8oajUpKf0jk3+RGdk5Qfgc5WcEbAZSsYj8tWMD4kW0FKSLbqsQrwIzovB/wItFEhAm3UHisFPwJlVBAeZFRIQRsVItBGhQi0UeECDGdUGI8zKowPMSqkhBgVUtBGhQi0USECbVSIQBsVItBGDVzbe8ODjAopaKNCBNqoEIE2ql0v9jAqjMcZFcaHGBVSQowKKWijQgTaqBCBNipEoI0KEWijQgTKqCA8yKiQgjYqRKCNChFoo1a3GoYbFcbjjArjQ4wKKSFGhRS0USECbVSIQBsVItBGhQi0USECZVQQHmRUSEEbFSLQRoUItFHtycIeRoXxOKPC+BCjQkqIUSEFbVSIQBsVItBGhQi0USECbVSIQBkVhAcZFVLQRoUItFEhom181qcofZfZ7+GPenqv2O9+6qpu1J/urdwu6qA7atkqP6v7vQjnSj1FjTceHth6oxtETKRQ9hC157S6y7WXRKBOfP5+0X6Hj0vv+dCl+l4Ie84UwA+7RoJjKodtQ96NBEXeYdtIdyPBqvOwLfu6kWAaPGxLutaXy4tS9HQEgtvSjBO85wlvy9ZOOOzithztBMIebsvMTiDs4LZ87AQeRSY5v48+6thPo9X1pYDQNhwdwrGf0DYsoVbLdAyN0VU0P6Gren5CVxn9BJSeXgxeWD8KrbAfFSY1tBlW6nCj+glYqSEhSGqACZcaooKlhqgwqWFixEoNCVipw5OznxAkNcCESw1RwVJDVJjUcCrDSg0JWKkhASt1zwnZiwmXGqKCpYaoMKnh4g4rNSRgpYYErNSQECQ1wIRLDVHBUkNUmNSgSkZLDQlYqSEBKzUkBEkNMOFSQ1Sw1BDVJrU9irIhNUphJxy3CHMCcROyE4hLzk5gQLXkRAdWSw4hsFqCWi01x1VLrmh+Qlf1/ISuMvoJKD29GLywfhRaYT8qTGpctdQkdbhR/QSs1LhqySs1rlpqlRpXLbVKjauW/FLjqqUmqXHVUpPU4cnZTwiSGlcttUqNq5ZapcZVS36pcdVSk9S4aqlJaly11CR1zwnZiwmXGlcttUqNq5b8UuOqpSapcdVSk9S4aqlJaly15JUaVy21So2rllqlxlVLfqlx1VKT1LhqqUlqXLXUJDWuWvJKjauWWqXGVUutUuOqpVsdIggeATVOWV5GdM+Lu2LFrGT9H074kOW8UPKZJxHtrt6g9nL4svHzV4Ztf+pOf7/UfWaegO7crpRUT4CtgfaL18nqZ6pMsGlJVP90V/22bXB9urbaog2Em4pneltx/ewqz6bqZ9CubqKyT6B9v2HPg2ptQ9YDcPntukvX/VV9b6O3WttdmgHf0mZriNY+qjzja+CXOglsa6Fuz0RWv+ym/7jOEg14qX8urGpp8soqlP78gkt5y6pvq7n/q5JPy+rTvV37yIJ3n0+qp+9543Obpr2A4WZjqpf1r7h5+rt6Hn99/YB3SJpc1NDd9mKWvj29btvyr+Lr/wEAAP//AwBQSwMEFAAGAAgAAAAhAO1+eZxyAQAAxwIAABAACAFkb2NQcm9wcy9hcHAueG1sIKIEASigAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnFLLTsMwELwj8Q9R7tQpAoSqrRFqhTjwqNS0PVv2JrFwbMt2K/r3bEgbgrjh086sdzSzNjx8tiY7YIja2Xk+nRR5hlY6pW09zzfl09V9nsUkrBLGWZznR4z5A7+8gFVwHkPSGDOSsHGeNyn5GWNRNtiKOKG2pU7lQisSwVAzV1Va4tLJfYs2seuiuGP4mdAqVFd+EMx7xdkh/VdUOdn5i9vy6EmPQ4mtNyIhf+smzUS51AIbWChdEqbULfJrogcAK1Fj5FNgfQE7F1Tk98D6AhaNCEIm2h+/IXYE4dF7o6VItFj+qmVw0VUpe/92m3XjwMZXgBKsUe6DTkdeABtDeNG2t9EXZCuIOgjfnLwNCNZSGFxQdl4JExHYDwEL13phSY4NFel9xI0v3bJbw2nkNznKuNOpWXshycLt7TjtqAFrYlGR/cHBQMAzPUcwnTzN2hrV+c7fRre/bf8v+fRuUtD5XtiZo9jDh+FfAAAA//8DAFBLAQItABQABgAIAAAAIQDfpNJsWgEAACAFAAATAAAAAAAAAAAAAAAAAAAAAABbQ29udGVudF9UeXBlc10ueG1sUEsBAi0AFAAGAAgAAAAhAB6RGrfvAAAATgIAAAsAAAAAAAAAAAAAAAAAkwMAAF9yZWxzLy5yZWxzUEsBAi0AFAAGAAgAAAAhANZks1H0AAAAMQMAABwAAAAAAAAAAAAAAAAAswYAAHdvcmQvX3JlbHMvZG9jdW1lbnQueG1sLnJlbHNQSwECLQAUAAYACAAAACEApwv382IDAAB3DQAAEQAAAAAAAAAAAAAAAADpCAAAd29yZC9kb2N1bWVudC54bWxQSwECLQAUAAYACAAAACEAtvRnmNIGAADJIAAAFQAAAAAAAAAAAAAAAAB6DAAAd29yZC90aGVtZS90aGVtZTEueG1sUEsBAi0AFAAGAAgAAAAhAJBSIebaAwAAIgsAABEAAAAAAAAAAAAAAAAAfxMAAHdvcmQvc2V0dGluZ3MueG1sUEsBAi0AFAAGAAgAAAAhABFZMoRyAQAA8QIAABEAAAAAAAAAAAAAAAAAiBcAAGRvY1Byb3BzL2NvcmUueG1sUEsBAi0AFAAGAAgAAAAhAC4QuvbZAQAAHwYAABIAAAAAAAAAAAAAAAAAMRoAAHdvcmQvZm9udFRhYmxlLnhtbFBLAQItABQABgAIAAAAIQBAwf/xOQEAACMDAAAUAAAAAAAAAAAAAAAAADocAAB3b3JkL3dlYlNldHRpbmdzLnhtbFBLAQItABQABgAIAAAAIQDVGG/iTAsAAF5yAAAPAAAAAAAAAAAAAAAAAKUdAAB3b3JkL3N0eWxlcy54bWxQSwECLQAUAAYACAAAACEA7X55nHIBAADHAgAAEAAAAAAAAAAAAAAAAAAeKQAAZG9jUHJvcHMvYXBwLnhtbFBLBQYAAAAACwALAMECAADGKwAAAAA="
    }
  });

  let config = {
    method: 'post',
    url: 'https://cdogs-dev.apps.silver.devops.gov.bc.ca/api/v2/template/render',
    responseType: 'arraybuffer',
    headers: { 
      'Authorization': 'Bearer ' + cdogsToken, 
      'Content-Type': 'application/json'
    },
    data : data
  };
  const axios = require('axios');
  return axios(config).then(response => {return response.data})
  .catch(error => {
      console.log(error.response)
  });
  
}}